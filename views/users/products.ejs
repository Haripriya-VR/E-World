<%-include('../partials/userheader') %>
  <!-- View all products -->

  <body style=" background-color: #D5E6E5;">


    <section>
      <div class="container-fluid p-0 d-flex">
        <!-- sidebar  -->
        <div class="col-md-2  d-flex flex-column" style="background: #D9D9D9; ">
          <!-- Side section content -->

          <!-- search feature -->
          <div class="search-content-admin d-flex mx-auto my-4 bg-light ">
            <form action="/products/search" method="post">
              <input type="text" class="search px-4 py-2" placeholder="Search category" name="search">
              <button type="submit" class="search-btn mx-0"><i class="fa fa-search fa-xl"></i></button>
            </form>
          </div>
          <!-- categories  -->
          <div class="d-flex">
            <a href="#" class="text-decoration-none text-dark">
              <h5 class="fw-bold ps-3 ">Categories</h5>
            </a>
            <i class="fa-solid fa-chevron-down pt-1 ms-auto me-5 " id="toggleCategories"></i>
          </div>
          <ul id="categoriesList" class="list-unstyled class ps-4">
            <% categories.forEach((cat)=> { %>
              <li>
                <a href="/products?category=<%= cat._id %>" class="text-decoration-none text-dark">
                  <%= cat.category %>
                </a>
              </li>
              <% }); %>
          </ul>
          <!-- filter by price -->
          <div class="d-flex">
            <a href="#" class="text-decoration-none text-dark">
              <h5 class="fw-bold ps-3 ">Filter by Price</h5>
            </a>
            <i class="fa-solid fa-chevron-down pt-1 ms-auto me-5 " id="togglePrice"></i>
          </div>
          <!-- <ul id="PriceList" class="list-unstyled class ps-4" style="display: none;">
                <li> <a class="dropdown-item" href="/filter?price=a-z" >
                    <p>Lowest to Highest </p>
                </a></li>
            <li><a class="dropdown-item" href="/filter?price=z-a">
                    <p>Highest to Lowest </p>
                </a></li>
            </ul> -->

          <ul id="PriceList" class="list-unstyled class ps-4" style="display: none;">       
              <li> <a class="dropdown-item" href="/products?price=a-z">
                <p>Lowest to Highest </p>
            </a>
          </li>
            <li><a class="dropdown-item" href="/products?price=z-a">
              <p>Highest to Lowest </p>
          </a>
        </li>
          </ul>
        </div>

        <div class="col-md flex-grow-1 main-section p-5">
          <!-- Main section content -->

          <div class="container product-cards">
            <div class="row">
              <!-- cards -->
              <% products.forEach(product=> { %>
                <div class="col-md-3 mb-4">
                  <div class="card card-products h-100">
                    <div class="card-body d-flex flex-column shadow">
                      <a href="/users/single-product/<%= product._id %>">
                        <img src="/<%= product.images[0] %>" class="card-img-top" alt="Product Image">
                      </a>
                      <div class="card-text flex-grow-1">
                        <h5 class="card-title fw-bold mt-2">
                          <%= product.name %>
                        </h5>
                      </div>
                      <p class="card-text mt-3 fw-bold">Price: Rs <%= product.price %>
                      </p>
                      <div>
                        <button type="button" class="cart-button btn-block mt-3">Add to Cart</button>
                        <a href="#" class="ms-2"><i class="fa-solid fa-heart fa-xl" style="color: #4b1c70;"></i></a>
                      </div>
                    </div>
                  </div>
                </div>
                <% }); %>
            </div>
          </div>

          <div class="d-flex justify-content-center">
            <nav aria-label="Page navigation example" class="d-flex justify-content-center mt-3">
              <ul class="pagination">
                <% if (page> 1) { %>
                  <li class="page-item">
                    <a class="page-link" href="?page=<%= page - 1 %>&limit=8" aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                  <% } else { %>
                    <li class="page-item disabled">
                      <span class="page-link" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                      </span>
                    </li>
                    <% } %>
                      <% for (let i=1; i <=totalPages; i++) { %>
                        <li class="page-item <%= page === i ? 'active' : '' %>">
                          <a class="page-link" href="?page=<%= i %>&limit=8">
                            <%= i %>
                          </a>
                        </li>
                        <% } %>
                          <% if (page < totalPages) { %>
                            <li class="page-item">
                              <a class="page-link" href="?page=<%= page + 1 %>&limit=8" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                              </a>
                            </li>
                            <% } else { %>
                              <li class="page-item disabled">
                                <span class="page-link" aria-label="Next">
                                  <span aria-hidden="true">&raquo;</span>
                                </span>
                              </li>
                              <% } %>

              </ul>
            </nav>
          </div>
        </div>
      </div>




    </section>


    <script>
      document.getElementById('toggleCategories').addEventListener('click', function () {
        var categoriesList = document.getElementById('categoriesList');
        categoriesList.style.display = (categoriesList.style.display === 'none' || categoriesList.style.display === '') ? 'block' : 'none';

      });
      document.getElementById('togglePrice').addEventListener('click', function () {
        var PriceList = document.getElementById('PriceList');
        PriceList.style.display = (PriceList.style.display === 'none' || PriceList.style.display === '') ? 'block' : 'none';
      })
    </script>

  </body>