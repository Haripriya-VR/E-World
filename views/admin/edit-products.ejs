<%-include('../partials/adminheader') %>

  <body>
    <div class="container-fluid main-content ">
      <div class="  product-content shadow  my-5  d-flex">
        <div class="container signup-details">
          <h2 class="fw-bold text-dark text-center py-4">Edit Products</h2>
          <form action="/admin/edit-products/<%= product._id %>" method="post" id="form" enctype="multipart/form-data"
            onsubmit="return validateProductForm()">
            <div class="form-group input-control input-box py-2 ">
              <label for="productname">Product Name:</label>
              <input type="text" id="productname" name="productname" class="form-control" value="<%= product.name %>">
              <div class="error"></div>

            </div>

            <div class="form-group input-control input-box py-2">
              <label for="Category">Select Category:</label>
              <select id="Category" name="Category" class="form-control">
                <option value="" disabled>Select Category</option>
                <% categories.forEach((cat)=> { %>
                  <option value="<%= cat.category %>" <%=cat.category===product.category ? 'selected' : '' %>><%=
                      cat.category %>
                  </option>
                  <% }); %>
              </select>
              <div class="error"></div>

            </div>
            <!-- price -->
            <div class="form-group input-control input-box py-2 ">
              <label for="price">Price:</label>
              <input type="number" id="price" name="price" class="form-control" value="<%= product.price %>">
              <div class="error"></div>
            </div>

            <div class="form-group input-control input-box py-2">
              <label for="quantity">stock:</label>
              <input type="text" id="quantity" name="quantity" class="form-control" value="<%= product.quantity %>">
              <div class="error"></div>

            </div>
            <div class="form-group input-control input-box py-2">
              <div class="image">
                <% for (let i=1; i <=3; i++) { %>
                  <div class="inner-img d-flex">
                    <label for="productimage<%= i %>">Choose Image <%= i %>:</label>
                    <input type="file" id="productimage<%= i %>" name="productImages"
                      class="form-control-file productimage" onchange="getImagePreview(event, 'preview<%= i %>')"
                      multiple>
                    <div id="preview<%= i %>" class="preview-container"></div>
                  </div>
                  <% } %>
              </div>
            </div>


            <!-- Description Textarea -->
            <div class="form-group input-control input-box py-3">
              <label for="productdescription">Product Description:</label>
              <textarea id="productdescription" name="description" class="form-control"
                placeholder="Enter product description" value="<%= product.description %>"></textarea>
            </div>
            <div class="form-group input-control input-box pt-3 ">
              <button class="btn1 shadow text-white" type="submit" value="Sign In">Edit Products</button>
            </div>

          </form>
        </div>
      </div>
    </div>
    <script>
      function validateForm() {
        // You can add more advanced validation if needed
        return true; // Return true to submit the form, or false to prevent it
      }

      function validateProductForm() {
        // Basic validation for non-negative values in price and stock fields
        const price = document.getElementById('price').value;
        const stock = document.getElementById('stock').value;

        if (price < 0 || stock < 0) {
          alert('Please enter non-negative values for price and stock.');
          return false; // Prevent form submission
        }

        return true; // Allow form submission
      }
    </script>

    <script src="/static/js/admin/product.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

  </body>